@page
@using BibliotecaAPI.Models
@model BibliotecaAPI.Pages.IndexModel
@{
    Layout = "Shared/_Layout";
    ViewData["Title"] = "Lista de Livros";
}

<h1 class="text-3xl font-bold mb-6 text-gray-800 flex items-center gap-2">
    ðŸ“š Lista de Livros
</h1>

<div class="overflow-x-auto bg-white shadow rounded-lg border border-gray-200">
    <table class="min-w-full divide-y divide-gray-200 text-sm text-gray-700">
        <thead class="bg-gray-100">
            <tr>
                <th class="px-6 py-3 text-left font-semibold">TÃ­tulo</th>
                <th class="px-6 py-3 text-left font-semibold">Autor</th>
                <th class="px-6 py-3 text-left font-semibold">Ano</th>
                <th class="px-6 py-3 text-left font-semibold">DisponÃ­vel?</th>
                <th class="px-6 py-3 text-left font-semibold">AÃ§Ãµes</th>
            </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">

        @{
            System.Diagnostics.Debug.Assert(Model.Books != null, "Model.Books != null");
        }
        @if (Model.Books == null || !Model.Books.Any())
            {
                <tr><td colspan="5" class="text-center text-gray-400 py-4">Nenhum livro encontrado.</td></tr>
            }
            else
            {
                foreach (var book in Model.Books)
                {
                    <tr class="hover:bg-gray-50 transition">
                        <td class="px-6 py-4">@book.Title</td>
                        <td class="px-6 py-4">@book.Author</td>
                        <td class="px-6 py-4">@book.PublicationYear</td>
                        <td class="px-6 py-4">
                            <span class="inline-block px-2 py-1 rounded-full text-xs font-medium
                                @(book.AvailableForLoan ? "bg-green-100 text-green-700" : "bg-red-100 text-red-700")">
                                @(book.AvailableForLoan ? "Sim" : "NÃ£o")
                            </span>
                        </td>
                        <td class="px-6 py-4">
                            <form method="post" asp-page-handler="Edit">
                                <input type="hidden" name="editBookId" value="@book.Id" />
                                <button class="text-blue-600 hover:text-blue-800" title="Editar">Editar</button>
                            </form>
                        </td>
                    </tr>
                }
            }
        </tbody>
    </table>
</div>

@if (Model.EditBookId.HasValue)
{
    <!-- Modal de EdiÃ§Ã£o -->
    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-md">
            <h2 class="text-xl font-bold mb-4">Editar Livro</h2>
            <form method="post" asp-page-handler="Save">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700">TÃ­tulo</label>
                    <input asp-for="Book.Title" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" required />
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700">Autor</label>
                    <input asp-for="Book.Author" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" required />
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700">Ano</label>
                    <input asp-for="Book.PublicationYear" type="number" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" required />
                </div>
                <div class="mb-4 flex items-center">
                    <input asp-for="Book.AvailableForLoan" type="checkbox" class="mr-2" />
                    <label class="text-sm">DisponÃ­vel para EmprÃ©stimo</label>
                </div>
                <input asp-for="EditBookId" type="hidden"/>
                <div class="flex justify-end gap-2">
                    <a href="" class="px-4 py-2 bg-gray-300 text-gray-800 rounded hover:bg-gray-400">Cancelar</a>
                    <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Salvar</button>
                </div>
            </form>
        </div>
    </div>
}
